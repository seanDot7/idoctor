<!doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<script type="text/javascript" src="jquery.min.js"></script>
	<script type="text/javascript" src="highcharts.js"></script>
	<script type="text/javascript" src="exporting.js"></script>
	<script>
		var result = '';
		//'2015-05-04 01:36:18.0,125.0,70.0;2015-05-04 01:36:20.0,125.0,70.0;2015-05-03 05:14:49.0,126.0,70.0;2015-05-02 05:14:49.0,131.0,84.0;2015-05-01 05:14:49.0,127.0,73.0;2015-05-05 10:35:54.0,146.0,96.0;2015-05-05 10:36:49.0,143.0,96.0;2015-05-05 10:49:06.0,127.0,98.0'

		Highcharts.setOptions({
	    	lang:{
		       
		       months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],
		       
		       shortMonths: ["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],

		    }
		});

		function getResult(resultString){
			result = resultString;
			alert(result);
			$(function () {
				$('#container').highcharts({
				    chart: {
				        type: 'spline'
				    },
				    title: {
				        text: '近期血压'
				    },
				    xAxis: {
				        type: 'datetime',
				        dateTimeLabelFormats: {
	                		day: '%b%e日'
	            		}
				    },
				    yAxis: {
				        title: {
				            text: '血压 (mmHg)'
				        },
				    },
					tooltip: {
						enabled: true,
						formatter: function() {
							return '<b>'+ this.series.name +'</b><br/>'+Highcharts.dateFormat('%m月%d日 %H:%M', this.x) +' '+ this.y +'mmHg';
						}
					},
					plotOptions: {
						spline: {
							dataLabels: {
								enabled: true
							},
						enableMouseTracking: true
						}	
					},
				    
				    series: [
				    {
				    	name: "高压",
				        data: genData(0)
				    },
				    {
				    	name: "低压",
				      	data: genData(1)
				    }
				    ]
				});
				
				function timeStringToUtC(timeString){
					year=timeString.split(' ')[0].split('-')[0];
					month=parseInt(timeString.split(' ')[0].split('-')[1])-1;
					date=timeString.split(' ')[0].split('-')[2];
					hour=timeString.split(' ')[1].split(':')[0];
					min=timeString.split(' ')[1].split(':')[1];
					sec=timeString.split(' ')[1].split(':')[2];
					return Date.UTC(year,month,date,hour,min,sec);
				}
				function genData(item_id){
					var dataArr=new Array();
					var rlist = result.split(';');
					if (item_id==0){
						for (var i = rlist.length - 1; i >= 0; i--) {
							dataArr[i]=[timeStringToUtC(rlist[i].split(',')[0]),Number(rlist[i].split(',')[1])];
						};
					}
					else{
						for (var i = rlist.length - 1; i >= 0; i--) {
							dataArr[i]=[timeStringToUtC(rlist[i].split(',')[0]),Number(rlist[i].split(',')[2])];
						};
					}
					// console.log(dataArr);
					return dataArr;
				}
			});
		}

		
	</script>
</head>
<body>
	<div id="container" ></div>
</body>
</html>