<!doctype html>
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	<script type="text/javascript" src="http://cdn.hcharts.cn/jquery/jquery-1.8.3.min.js"></script>
	<script type="text/javascript" src="http://cdn.hcharts.cn/highcharts/highcharts.js"></script>
	<script type="text/javascript" src="http://cdn.hcharts.cn/highcharts/modules/exporting.js"></script>
	<script>
		var result = '';

		function getResult(resultString){
			result = resultString;
			alert(result);
			$(function () {
				$('#container').highcharts({
				    chart: {
				        type: 'spline'
				    },
				    title: {
				        text: '近期血压'
				    },
				    xAxis: {
				        type: 'datetime',
				    },
				    yAxis: {
				        title: {
				            text: '血压 (mmHg)'
				        },
				    },
					tooltip: {
						enabled: true,
						formatter: function() {
							return '<b>'+ this.series.name +'</b><br/>'+Highcharts.dateFormat('%m月%d日 %H:%M', this.x) +' '+ this.y +'mmHg';
						}
					},
					plotOptions: {
						spline: {
							dataLabels: {
								enabled: true
							},
						enableMouseTracking: true
						}	
					},
				    
				    series: [
				    {
				    	name: "高压",
				        data: genData(0)
				    },
				    {
				    	name: "低压",
				      	data: genData(1)
				    }
				    ]
				});
				
				function timeStringToUtC(timeString){
					year=timeString.split(' ')[0].split('-')[0];
					month=parseInt(timeString.split(' ')[0].split('-')[1])-1;
					date=timeString.split(' ')[0].split('-')[2];
					hour=timeString.split(' ')[1].split(':')[0];
					min=timeString.split(' ')[1].split(':')[1];
					sec=timeString.split(' ')[1].split(':')[2];
					return Date.UTC(year,month,date,hour,min,sec);
				}
				function genData(item_id){
					var dataArr=new Array();
					var rlist = result.split(';');
					if (item_id==0){
						for (var i = rlist.length - 1; i >= 0; i--) {
							dataArr[i]=[timeStringToUtC(rlist[i].split(',')[0]),Number(rlist[i].split(',')[1])];
						};
					}
					else{
						for (var i = rlist.length - 1; i >= 0; i--) {
							dataArr[i]=[timeStringToUtC(rlist[i].split(',')[0]),Number(rlist[i].split(',')[2])];
						};
					}
					// console.log(dataArr);
					return dataArr;
				}
			});
		}

		
	</script>
</head>
<body>
	<div id="container" ></div>
</body>
</html>